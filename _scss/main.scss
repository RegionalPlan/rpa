@import "bootstrap";

.map{
  width:100%;height:700px;
  & > .mapInner{
    width:inherit;
    height:inherit;
  };
  position:relative;
  // callout
  .please_zoom_in{
    background: white;
    padding: 10px 20px;
    color:black;
    position:absolute;
    bottom:10px;
    left:10px;
  }
  .cartodb-logo{display:none !important;}
}
.content{
  margin-top:-20px;
}


@mixin popup($infowindow_width: 397.5px, $infowindow_height: $infowindow_width/2 + 10px) {

  // INFOWINDOW

  // $infowindow_width: 530px * 3/4;
  // $infowindow_height: $infowindow_width/2 + 10px;

  $blue: #47b3d2;         // disp_income
  $reddish: #f12b15;      // trans
  $brown: #b92b15;        // housing
  $dark_brown: #7c2b15;   // taxes

  div.cartodb-infowindow{
    width: $infowindow_width !important;
    height: $infowindow_height !important;
    max-height: $infowindow_height !important;

    .leftColumn{
      float:left;
      width:205px;
      font-size:0.7em;
      & > div:before{
        content: '\00B7';
        padding-right: 5px;
        font-size: 42px;
        line-height: 10px;
        float:left;
        margin-top:3px;
        height:24px;
      }

      & > .discretionary:before{
        color: $blue;
      }
      & > .trans:before{
        color: $reddish;
      }
      & > .housing:before{
        color: $brown;
      }
      & > .taxes:before{
        color: $dark_brown;
      }
    }
    .rightColumn{
      float:left;
      position:relative;
      width:143px;
      #donut{
        cursor: crosshair;
      }
    }
    .mhi{
      position: absolute;
      left: 43px;
      z-index: 99;
      top: 36px;
      font-size: 0.8em;
    }
    a.cartodb-popup-close-button{
      top: 18px;
      right:13px;

    }


  }
  div.cartodb-popup{
    width:$infowindow_width;
    height: $infowindow_height !important;
    max-height: $infowindow_height !important;
    background: white;
    max-width:$infowindow_width;
    padding:0;

    div.cartodb-popup-tip-container{
      display:none;
    }

    // Bubble triangle
    &:after {
      content: ' ';
      position: absolute;
      width: 0;
      height: 0;
      left: 5%;
      bottom: -15px;
      border: 15px solid;
      border-color: #fff transparent transparent #fff;
    }

    div.cartodb-popup-content-wrapper{
      width:$infowindow_width;
      height: $infowindow_height !important;
      max-height: $infowindow_height !important;
      background: white;
      max-width:$infowindow_width;
      overflow: hidden;

      @include border-left-radius(5px);
      @include border-right-radius(5px);
      @include border-top-radius(5px);
      @include border-bottom-radius(5px);

      box-shadow: 1px 1px 6px black;

      .cartodb-popup-content{
        overflow:hidden;
      }
      .cartodb-popup-content, .jspContainer, .jspPane{
        width:$infowindow_width - 60px !important;
        max-width:$infowindow_width;
        height: $infowindow_height !important;
        max-height: $infowindow_height !important;
      }
      .jspPane {
        font-size: 1.2em;
        & > div, & > h2{
          padding-left:3px;
        }
      }
      .jspVerticalBar{display:none;}

      .title{
        border-bottom: solid 1px #ccc;
        margin-bottom:10px;
      }
    }
  }
}


// PAGES
.page.discretionary{
  min-height: 1000px;

  .standalone{
    margin-top:20px;
    $infowindow_width: 417.5px;
    @include popup($infowindow_width, $infowindow_width/2 + 20px);
    div.cartodb-infowindow:after,div.cartodb-popup:after{ display:none;}
  }
}


// MAPS

#schoolPerf{

  // School rank colors
  $bottom: #ba0000;
  $middle: #515151;
  $top: #0082ac;
  $nodata: #a7907b;

  // INFOWINDOW
  .Bottom{
    color: $bottom;
  }
  .Top{
    color: $top;
  }
  .Middle{
    color: $middle;
  }

  // LEGEND
  .cartodb-legend-stack{
    width:240px;
  }
  .cartodb-legend{
    b{
      display:block;
      margin-bottom:10px;
    }

  }
  .school-rank-legend{
    .note{
      font-size: 10px;
    }
    div{
      p{
        &:nth-child(1){ color: $top;}
        &:nth-child(2){ color: $middle;}
        &:nth-child(3){ color: $bottom;}
        &:nth-child(4){ color: $nodata;}
      }
    }
  }


  // Income colors
  $color1: #beb4aa;
  $color2: rgba($color1, 0.8);
  $color3: rgba($color1, 0.6);
  $color4: rgba($color1, 0.4);
  $color5: rgba($color1, 0.2);

  .colors{
    $i:1;
    @each $color in $color1, $color2, $color3, $color4, $color5 {
      div:nth-child(#{$i}){
        background-color: $color;
      }
      $i: $i + 1;
    }
  }

  @include popup(397.5px,150px);

  .school-ranking{
    font-weight:bold;
  }

}

.page.vulnerable{

  #layer_selector{
    position: absolute;
    bottom: 30px;
    right:10px;
    padding:0;
    ul{
      list-style: none;
      margin: 0;
      padding: 0;
      li{
        cursor:pointer;
        padding: 5px 10px;
        display:block;
        width:100%;
        text-decoration:none;
        &.active{
          background: rgba(0,0,0,0.1);
        }
      }
    }
  }

  #vulnerableInfra{
    // LEGEND
    div.cartodb-legend.custom{
      width:145px;
      li.graph{
        height:125px;
        border:none;
      }
      div.colors{
        div.quartile{
          display:block;
          margin-bottom:1px;
          &:after{
            width: 150px;
            float: left;
            display: block;
            margin: 5px 0 10px 0;
            text-transform:lowercase;
          }
        }
      }
    }
  }
}


#discretionaryIncome{
  // LEGEND
  div.cartodb-legend.custom{
    width:150px;
    h5{
      margin-top:0;
      font-weight:bold;
      font-size:1em;
    }

    li.graph{
      height:120px;
      border:none;
    }
    div.colors{
      div.quartile{
        display:block;
        margin-bottom:1px;
        height:20px;
        width:20px;
        &:after{
          width: 150px;
          float: left;
          display: block;
          margin: 5px 0 0 25px;
          text-transform:lowercase;
        }
      }
    }
    $i:1;
    $blue1: #0b6087 "$40,000 and over";
    $blue2: #1689ae "$32,001 - $40,000";
    $blue3: #4cb3d1 "$24,001 - $32,000";
    $blue4: #82d5e7 "$16,001 - $24,000";
    $blue5: #b7ebf2 "$16,000 and under";
    $col_text: $blue1, $blue2, $blue3, $blue4, $blue5;
    @each $value in $col_text {
      .col#{$i}{
        background-color:nth($value,1);
        &:after{
          content:nth($value,2);
        }
      }
      $i: $i + 1;
    }

  }
  $infowindow_width: 427.5px;
  @include popup($infowindow_width, $infowindow_width/2 + 20px);

}
